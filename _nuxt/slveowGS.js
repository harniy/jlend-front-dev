import{a as mt,b as Vt,w as $t,C as Pt,s as At,R as Rt,u as jt,i as xt,c as nt,g as It,d as wt,_ as zt,e as Ht,D as ut}from"./CIugqyQC.js";import{d as lt,s as pt,c as D,g as bt,r as z,v as vt,w as ft,x as Ot,h as Q,o as k,l as _,e as d,b as L,a as P,j as Z,u as r,i as st,f as I,t as g,F as K,y as G,n as U,D as St,k as H,p as q,E as J,z as Ut,A as Yt,B as qt,_ as Mt}from"./C9l8dZ-Y.js";import{u as gt,a as yt,c as Lt,b as ot,e as Et,h as et,_ as Nt,g as Ct,d as Wt,t as ht,i as Kt,k as Xt,s as Dt,l as rt,j as Jt,f as Gt}from"./CxfhhUng.js";import{z as Bt,s as Qt,w as Zt,y as te,_ as ee,r as se}from"./BOF5tWtN.js";import{_ as ie}from"./DPJN_AxG.js";import{s as ae}from"./R_fNjJy0.js";const oe={class:"multiply-dialog__title"},le={class:"multiply-dialog__body"},re={class:"multiply-dialog__data"},ne={key:0,class:"dialog-info-table"},de={class:"multiply-dialog-action"},ue=lt({__name:"WithdrawLeverageDialog",props:pt({data:{}},{modelValue:{type:Boolean,default:!1},modelModifiers:{}}),emits:["update:modelValue"],setup(e){const t=gt(),s=yt(),i=Lt(),o=D(()=>i.userObligation),a=bt(s,"withdrawAmount"),p=mt(),x=D(()=>p.jLendClient),l=D(()=>p.assetDecimals),S=Vt(),C=D(()=>S.publicKey),j=D(()=>{var A;if(!e.data)return 0;const u=e.data.depositPool,n=(A=o.value)==null?void 0:A.deposits.find(O=>O.includes(u==null?void 0:u.pool_address));if(!n)return 0;const V=n[1].shares||0,b=Number(V)/Number(u.total_shares||0),$=Number(ot(u.available,l.value)),w=Number(ot(u.total_borrowed,l.value));return($+w)*b||0}),B=D(()=>{var u;return t.poolDepositAddr===((u=e.data)==null?void 0:u.depositPool.pool_address)}),E=z(!1),F=z(0);$t([()=>e.data,E,C],async([u,n])=>{var b;if(!u||!C.value)return;const V=await((b=x.value)==null?void 0:b.sdk.withdrawLeverageTx(C.value,(u==null?void 0:u.depositPool.pool_address)||"",(u==null?void 0:u.borrowPool.pool_address)||"",1));F.value=x.value.sdk.getTransactionFee(V)},{immediate:!0,debounce:300});const f=D(()=>e.data?[{name:"txFee",label:"Transaction Fee",value:`${F.value||0} ${e.data.asset.symbol}`}]:[]),y=vt(e,"modelValue");async function R(){var b,$,w,c;if(!C.value||!((b=e.data)!=null&&b.depositPool.pool_address))return;if(!a.value||a.value<=0){Ct(".multiply-dialog");return}const u=($=e.data)==null?void 0:$.depositPool.pool_address,n=(w=e.data)==null?void 0:w.borrowPool.pool_address,V=(c=e.data)==null?void 0:c.depositPool.token_ticker;!u||!n||await s.withdrawLeverage(u,n,Number(a.value),V)}let N;return ft(y,async u=>{if(clearInterval(N),!u){setTimeout(()=>{a.value=0},Pt);return}N=At(()=>{E.value=!0,Ot(()=>{E.value=!1})},Rt)}),(u,n)=>{const V=Et,b=Bt,$=Nt;return k(),Q($,{modelValue:y.value,"onUpdate:modelValue":n[1]||(n[1]=w=>y.value=w),"class-name":"multiply-dialog"},{header:_(()=>{var w;return[d("div",oe,[d("span",null,"Withdraw "+g((w=u.data)==null?void 0:w.asset.symbol),1)])]}),default:_(()=>{var w,c;return[d("div",le,[d("div",re,[L(V,{modelValue:r(a),"onUpdate:modelValue":n[0]||(n[0]=h=>st(a)?a.value=h:null),balance:r(j),class:"multiply-dialog__input",icon:(w=u.data)==null?void 0:w.asset.icon,"label-left":"You Deposit",rules:[h=>h&&Number(h)<r(j)||"Insufficient balance"]},{"label-right":_(()=>{var h;return[I(" Multiplied: "+g(r(et)(r(j),0,7))+" "+g((h=u.data)==null?void 0:h.asset.symbol),1)]}),_:1},8,["modelValue","balance","icon","rules"]),r(f).length>0?(k(),P("div",ne,[(k(!0),P(K,null,G(r(f),h=>(k(),P("div",{key:h==null?void 0:h.label,class:"dialog-info-table__item"},[d("span",null,g(h==null?void 0:h.label),1),d("span",null,g(h==null?void 0:h.value),1)]))),128))])):Z("",!0),d("div",de,[L(b,{variant:"primary",loading:r(B),pool:(c=u.data)==null?void 0:c.depositPool,onClickHandler:R},{default:_(()=>{var h;return[I(" Withdraw "+g((h=u.data)==null?void 0:h.asset.symbol),1)]}),_:1},8,["loading","pool"])])])])]}),_:1},8,["modelValue"])}}}),ce={class:"multiply-chart"},he={class:"loop-multiply__title"},me={class:"loop-multiply__chart"},pe={class:"loop-multiply__legend"},be=lt({__name:"MultiplyApyChart",setup(e){const t=[2,3,4,5],s=t.map((f,y)=>{const R=Array.from({length:180}).map((N,u)=>{const n=new Date;return n.setDate(n.getDate()-u),{apy:5+y,timestamp:n}});return{[f]:R}}),i=["#00C4FF","#03B46D","#FFD600","#FFB24D"],o=D(()=>t.reduce((f,y,R)=>(f[String(y)]=i[R],f),{})),{width:a}=jt(),p=D(()=>a.value<=650),x=Qt(),l=bt(x,"activeFilter"),S=z(5),C=z(0);function j(f,y=!1){if(!f)return"";const R=String(f.getDate()).padStart(2,"0"),N=String(f.getMonth()+1).padStart(2,"0");let u=`${R}.${N}`;if(y){const n=String(f.getFullYear()).padStart(2,"0");u+=`.${n}`}return u}const B=z({labels:[],datasets:[]}),E=D(()=>s);ft([E,l],([f,y])=>{var u;if(!f)return;const R=[],N={};for(let n=0;n<(f==null?void 0:f.length);n++){const V=f[n],b=Object.keys(V)[0],$=x.filterData(Object.values(V).flat()),w=($==null?void 0:$.sort((c,h)=>new Date(c.timestamp).getTime()-new Date(h.timestamp).getTime()))||[];if(R.length===0)for(let c=0;c<(w==null?void 0:w.length);c++){const h=(u=w[c])==null?void 0:u.timestamp;R.push(h)}N[`multiplier_${b}`]=w==null?void 0:w.map(c=>(c==null?void 0:c.apy)||0)}B.value={labels:R,datasets:t.map(n=>({type:"line",label:String(n),borderColor:o.value[String(n)],backgroundColor:o.value[String(n)],data:(N==null?void 0:N[`multiplier_${n}`])||[]}))},S.value=Math.max(...Object.values(N).flat())+1||15,C.value=Math.min(...Object.values(N).flat())-1||0},{immediate:!0});const F=D(()=>({responsive:!0,maintainAspectRatio:!1,borderWidth:2,pointRadius:0,pointHoverRadius:4,interaction:{intersect:!1,mode:"index"},scales:{y:{position:"left",max:Math.ceil(S.value),min:Math.floor(C.value),ticks:{stepSize:1,color:xt.value?"#5B5B5B":"#111",callback:(f,y,R)=>y===R.length-1?"APY":`${f}%`,font:{size:p.value?8:12}},grid:{color:xt.value?"#2F2F2F":"#EBEBEB",drawBorder:!1},border:{display:!1}},x:{ticks:{callback(f){const y=this.getLabelForValue(Number(f));return Zt(y,l.value.value===180)}}}},plugins:{layout:{padding:{bottom:0}},legend:{display:!1},tooltip:{boxPadding:4,usePointStyle:!0,bodySpacing:8,callbacks:{title(f){var y;return j(new Date((y=f[0])==null?void 0:y.label),!0)},label(f){return`${f.dataset.label}x: ${Number(f.raw).toFixed(2)}%`}}}}}));return(f,y)=>{var u;const R=te,N=ee;return k(),P("div",ce,[d("div",he,[y[1]||(y[1]=I(" Historical APR ")),L(R,{modelValue:r(l),"onUpdate:modelValue":y[0]||(y[0]=n=>st(l)?l.value=n:null),filters:r(x).filters},null,8,["modelValue","filters"])]),d("div",me,[(k(),Q(N,{key:r(a),"chart-data":r(B),"chart-options":r(F),"chart-height":"196px","max-ticks-limit":6},null,8,["chart-data","chart-options"]))]),d("div",pe,[(k(!0),P(K,null,G((u=Object.entries(r(o)))==null?void 0:u.sort((n,V)=>Number(n[0])-Number(V[0])),([n,V])=>(k(),P("div",{key:n,class:"loop-legend-item"},[d("span",{style:U({"--color":String(V)})},null,4),I(" "+g(n)+"x ",1)]))),128))]),y[2]||(y[2]=d("div",{class:"loop-multiply__vault"},[d("div",{class:"loop-multiply__vault-title"}," Vault Info "),d("div",{class:"loop-multiply__vault-info"}," JUPSOL Multiply is a simple leveraged staking product that gives you increased exposure to JUPSOL staking yield, while retaining 100% SOL price exposure. This can enable users to earn higher SOL yields than they would by simply holding JUPSOL. Read more... ")],-1))])}}});(function(){try{if(typeof document<"u"){var e=document.createElement("style");e.appendChild(document.createTextNode('.vue-slider-dot{position:absolute;transition:all 0s;z-index:5}.vue-slider-dot:focus{outline:none}.vue-slider-dot-tooltip{position:absolute;visibility:hidden}.vue-slider-dot-hover:hover .vue-slider-dot-tooltip,.vue-slider-dot-tooltip-show{visibility:visible}.vue-slider-dot-tooltip-top{top:-10px;left:50%;transform:translate(-50%,-100%)}.vue-slider-dot-tooltip-bottom{bottom:-10px;left:50%;transform:translate(-50%,100%)}.vue-slider-dot-tooltip-left{left:-10px;top:50%;transform:translate(-100%,-50%)}.vue-slider-dot-tooltip-right{right:-10px;top:50%;transform:translate(100%,-50%)}.vue-slider-marks{position:relative;width:100%;height:100%}.vue-slider-mark{position:absolute;z-index:1}.vue-slider-ltr .vue-slider-mark,.vue-slider-rtl .vue-slider-mark{width:0;height:100%;top:50%}.vue-slider-ltr .vue-slider-mark-step,.vue-slider-rtl .vue-slider-mark-step{top:0}.vue-slider-ltr .vue-slider-mark-label,.vue-slider-rtl .vue-slider-mark-label{top:100%;margin-top:10px}.vue-slider-ltr .vue-slider-mark{transform:translate(-50%,-50%)}.vue-slider-ltr .vue-slider-mark-step{left:0}.vue-slider-ltr .vue-slider-mark-label{left:50%;transform:translate(-50%)}.vue-slider-rtl .vue-slider-mark{transform:translate(50%,-50%)}.vue-slider-rtl .vue-slider-mark-step{right:0}.vue-slider-rtl .vue-slider-mark-label{right:50%;transform:translate(50%)}.vue-slider-ttb .vue-slider-mark,.vue-slider-btt .vue-slider-mark{width:100%;height:0;left:50%}.vue-slider-ttb .vue-slider-mark-step,.vue-slider-btt .vue-slider-mark-step{left:0}.vue-slider-ttb .vue-slider-mark-label,.vue-slider-btt .vue-slider-mark-label{left:100%;margin-left:10px}.vue-slider-btt .vue-slider-mark{transform:translate(-50%,50%)}.vue-slider-btt .vue-slider-mark-step{top:0}.vue-slider-btt .vue-slider-mark-label{top:50%;transform:translateY(-50%)}.vue-slider-ttb .vue-slider-mark{transform:translate(-50%,-50%)}.vue-slider-ttb .vue-slider-mark-step{bottom:0}.vue-slider-ttb .vue-slider-mark-label{bottom:50%;transform:translateY(50%)}.vue-slider-mark-step,.vue-slider-mark-label{position:absolute}.vue-slider-disabled{opacity:.5;cursor:not-allowed}.vue-slider-rail{background-color:#ccc;border-radius:15px}.vue-slider-process{background-color:#3498db;border-radius:15px}.vue-slider-mark{z-index:4}.vue-slider-mark:first-child .vue-slider-mark-step,.vue-slider-mark:last-child .vue-slider-mark-step{display:none}.vue-slider-mark-step{width:100%;height:100%;border-radius:50%;background-color:#00000029}.vue-slider-mark-label{font-size:14px;white-space:nowrap}.vue-slider-dot-handle{cursor:pointer;width:100%;height:100%;border-radius:50%;background-color:#fff;box-sizing:border-box;box-shadow:.5px .5px 2px 1px #00000052}.vue-slider-dot-handle-focus{box-shadow:0 0 1px 2px #3498db5c}.vue-slider-dot-handle-disabled{cursor:not-allowed;background-color:#ccc}.vue-slider-dot-tooltip-inner{font-size:14px;white-space:nowrap;padding:2px 5px;min-width:20px;text-align:center;color:#fff;border-radius:5px;border-color:#3498db;background-color:#3498db;box-sizing:content-box}.vue-slider-dot-tooltip-inner:after{content:"";position:absolute}.vue-slider-dot-tooltip-inner-top:after{top:100%;left:50%;transform:translate(-50%);height:0;width:0;border-color:transparent;border-style:solid;border-width:5px;border-top-color:inherit}.vue-slider-dot-tooltip-inner-bottom:after{bottom:100%;left:50%;transform:translate(-50%);height:0;width:0;border-color:transparent;border-style:solid;border-width:5px;border-bottom-color:inherit}.vue-slider-dot-tooltip-inner-left:after{left:100%;top:50%;transform:translateY(-50%);height:0;width:0;border-color:transparent;border-style:solid;border-width:5px;border-left-color:inherit}.vue-slider-dot-tooltip-inner-right:after{right:100%;top:50%;transform:translateY(-50%);height:0;width:0;border-color:transparent;border-style:solid;border-width:5px;border-right-color:inherit}.vue-slider-dot-tooltip-wrapper{opacity:0;transition:all .3s}.vue-slider-dot-tooltip-wrapper-show{opacity:1}.vue-slider{position:relative;box-sizing:content-box;-webkit-user-select:none;user-select:none;display:block;-webkit-tap-highlight-color:rgba(0,0,0,0)}.vue-slider-rail{position:relative;width:100%;height:100%;transition-property:width,height,left,right,top,bottom}.vue-slider-process{position:absolute;z-index:1}')),document.head.appendChild(e)}}catch(t){console.error("vite-plugin-css-injected-by-js",t)}})();var ve=Object.defineProperty,fe=(e,t,s)=>t in e?ve(e,t,{enumerable:!0,configurable:!0,writable:!0,value:s}):e[t]=s,M=(e,t,s)=>(fe(e,typeof t!="symbol"?t+"":t,s),s);const _t=(e,t)=>{const s=e.__vccOpts||e;for(const[i,o]of t)s[i]=o;return s},ge={emits:["drag-start"],props:{value:{type:[Number,String],default:0},tooltip:{type:String,required:!0},dotStyle:{type:Array,default:()=>({})},tooltipStyle:{type:Array,default:()=>({})},tooltipPlacement:{type:String,required:!0},tooltipFormatter:{type:[String,Array,Object,Function],default:void 0},focus:{type:Boolean,default:!1},disabled:{type:Boolean,default:!1}},computed:{dotClasses(){return["vue-slider-dot",{"vue-slider-dot-hover":this.tooltip==="hover"||this.tooltip==="active","vue-slider-dot-disabled":this.disabled,"vue-slider-dot-focus":this.focus}]},handleClasses(){return["vue-slider-dot-handle",{"vue-slider-dot-handle-disabled":this.disabled,"vue-slider-dot-handle-focus":this.focus}]},tooltipClasses(){return["vue-slider-dot-tooltip",[`vue-slider-dot-tooltip-${this.tooltipPlacement}`],{"vue-slider-dot-tooltip-show":this.showTooltip}]},tooltipInnerClasses(){return["vue-slider-dot-tooltip-inner",[`vue-slider-dot-tooltip-inner-${this.tooltipPlacement}`],{"vue-slider-dot-tooltip-inner-disabled":this.disabled,"vue-slider-dot-tooltip-inner-focus":this.focus}]},showTooltip(){switch(this.tooltip){case"always":return!0;case"none":return!1;case"focus":case"active":return!!this.focus;default:return!1}},tooltipValue(){return this.tooltipFormatter?typeof this.tooltipFormatter=="string"?this.tooltipFormatter.replace(/\{value\}/,String(this.value)):this.tooltipFormatter(this.value):this.value}},methods:{dragStart(e){if(this.disabled)return!1;this.$emit("drag-start")}}},ye=["aria-valuetext"],_e={class:"vue-slider-dot-tooltip-text"};function ke(e,t,s,i,o,a){return k(),P("div",{ref:"dot",class:J(a.dotClasses),"aria-valuetext":a.tooltipValue,onMousedown:t[0]||(t[0]=(...p)=>a.dragStart&&a.dragStart(...p)),onTouchstartPassive:t[1]||(t[1]=(...p)=>a.dragStart&&a.dragStart(...p))},[H(e.$slots,"dot",{},()=>[d("div",{class:J(a.handleClasses),style:U(s.dotStyle)},null,6)]),s.tooltip!=="none"?(k(),P("div",{key:0,class:J(a.tooltipClasses)},[H(e.$slots,"tooltip",{},()=>[d("div",{class:J(a.tooltipInnerClasses),style:U(s.tooltipStyle)},[d("span",_e,g(a.tooltipValue),1)],6)])],2)):Z("",!0)],42,ye)}const Ft=_t(ge,[["render",ke]]),xe={props:{mark:{type:Object,required:!0},hideLabel:{type:Boolean,default:!1},stepStyle:{type:Object,default:void 0},stepActiveStyle:{type:Object,default:void 0},labelStyle:{type:Object,default:void 0},labelActiveStyle:{type:Object,default:void 0}},computed:{marksClasses(){return["vue-slider-mark",{"vue-slider-mark-active":this.mark.active}]},stepClasses(){return["vue-slider-mark-step",{"vue-slider-mark-step-active":this.mark.active}]},labelClasses(){return["vue-slider-mark-label",{"vue-slider-mark-label-active":this.mark.active}]}},methods:{labelClickHandle(e){e.stopPropagation(),this.$emit("pressLabel",this.mark.pos)}}};function we(e,t,s,i,o,a){return k(),P("div",{class:J(a.marksClasses)},[H(e.$slots,"step",{},()=>[d("div",{class:J(a.stepClasses),style:U([s.stepStyle,s.mark.style,s.mark.active?s.stepActiveStyle:null,s.mark.active?s.mark.activeStyle:null])},null,6)]),s.hideLabel?Z("",!0):H(e.$slots,"label",{key:0},()=>[d("div",{class:J(a.labelClasses),style:U([s.labelStyle,s.mark.labelStyle,s.mark.active?s.labelActiveStyle:null,s.mark.active?s.mark.labelActiveStyle:null]),onClick:t[0]||(t[0]=(...p)=>a.labelClickHandle&&a.labelClickHandle(...p))},g(s.mark.label),7)])],2)}const Tt=_t(xe,[["render",we]]),at=e=>typeof e=="number"?`${e}px`:e,Se=e=>{const t=document.documentElement,s=document.body,i=e.getBoundingClientRect();return{y:i.top+(window.pageYOffset||t.scrollTop)-(t.clientTop||s.clientTop||0),x:i.left+(window.pageXOffset||t.scrollLeft)-(t.clientLeft||s.clientLeft||0)}},De=(e,t,s)=>{const i="targetTouches"in e?e.targetTouches[0]:e,o=Se(t),a={x:i.pageX-o.x,y:i.pageY-o.y};return{x:s?t.offsetWidth-a.x:a.x,y:s?t.offsetHeight-a.y:a.y}},Ve=(e,t)=>{if(t.hook){const s=t.hook(e);if(typeof s=="function")return s;if(!s)return null}switch(e.keyCode){case 38:return s=>t.direction==="ttb"?s-1:s+1;case 39:return s=>t.direction==="rtl"?s-1:s+1;case 40:return s=>t.direction==="ttb"?s+1:s-1;case 37:return s=>t.direction==="rtl"?s+1:s-1;case 35:return()=>t.max;case 36:return()=>t.min;case 33:return s=>s+10;case 34:return s=>s-10;default:return null}};class W{constructor(t){M(this,"num"),this.num=t}decimal(t,s){const i=this.num,o=this.getDecimalLen(i),a=this.getDecimalLen(t);let p=0;switch(s){case"+":p=this.getExponent(o,a),this.num=(this.safeRoundUp(i,p)+this.safeRoundUp(t,p))/p;break;case"-":p=this.getExponent(o,a),this.num=(this.safeRoundUp(i,p)-this.safeRoundUp(t,p))/p;break;case"*":this.num=this.safeRoundUp(this.safeRoundUp(i,this.getExponent(o)),this.safeRoundUp(t,this.getExponent(a)))/this.getExponent(o+a);break;case"/":p=this.getExponent(o,a),this.num=this.safeRoundUp(i,p)/this.safeRoundUp(t,p);break;case"%":p=this.getExponent(o,a),this.num=this.safeRoundUp(i,p)%this.safeRoundUp(t,p)/p;break}return this}plus(t){return this.decimal(t,"+")}minus(t){return this.decimal(t,"-")}multiply(t){return this.decimal(t,"*")}divide(t){return this.decimal(t,"/")}remainder(t){return this.decimal(t,"%")}toNumber(){return this.num}getDecimalLen(t){const s=`${t}`.split("e");return(`${s[0]}`.split(".")[1]||"").length-(s[1]?+s[1]:0)}getExponent(t,s){return Math.pow(10,s!==void 0?Math.max(t,s):t)}safeRoundUp(t,s){return Math.round(t*s)}}const $e={1:'The type of the "value" is illegal',2:'The prop "interval" is invalid, "(max - min)" must be divisible by "interval"',3:'The "value" must be greater than or equal to the "min".',4:'The "value" must be less than or equal to the "max".',5:'When "order" is false, the parameters "minRange", "maxRange", "fixed", "enabled" are invalid.'};class Pe{constructor(t){M(this,"dotsPos",[]),M(this,"dotsValue",[]),M(this,"data"),M(this,"enableCross"),M(this,"fixed"),M(this,"max"),M(this,"min"),M(this,"interval"),M(this,"minRange"),M(this,"maxRange"),M(this,"order"),M(this,"marks"),M(this,"included"),M(this,"process"),M(this,"adsorb"),M(this,"dotOptions"),M(this,"onError"),M(this,"cacheRangeDir",{}),this.data=t.data,this.max=t.max,this.min=t.min,this.interval=t.interval,this.order=t.order,this.marks=t.marks,this.included=t.included,this.process=t.process,this.adsorb=t.adsorb,this.dotOptions=t.dotOptions,this.onError=t.onError,this.order?(this.minRange=t.minRange||0,this.maxRange=t.maxRange||0,this.enableCross=t.enableCross,this.fixed=t.fixed):((t.minRange||t.maxRange||!t.enableCross||t.fixed)&&this.emitError(5),this.minRange=0,this.maxRange=0,this.enableCross=!0,this.fixed=!1),this.setValue(t.value)}setValue(t){this.setDotsValue(Array.isArray(t)?this.order?[...t].sort((s,i)=>this.getIndexByValue(s)-this.getIndexByValue(i)):[...t]:[t],!0)}setDotsValue(t,s){this.dotsValue=t,s&&this.syncDotsPos()}setDotsPos(t){const s=this.order?[...t].sort((i,o)=>i-o):t;this.dotsPos=s,this.setDotsValue(s.map(i=>this.getValueByPos(i)),this.adsorb)}getValueByPos(t){let s=this.parsePos(t);if(this.included){let i=100;this.markList.forEach(o=>{const a=Math.abs(o.pos-t);a<i&&(i=a,s=o.value)})}return s}syncDotsPos(){this.dotsPos=this.dotsValue.map(t=>this.parseValue(t))}get markList(){if(!this.marks)return[];const t=(s,i)=>{const o=this.parseValue(s);return{pos:o,value:s,label:s,active:this.isActiveByPos(o),...i}};return this.marks===!0?this.getValues().map(s=>t(s)):Object.prototype.toString.call(this.marks)==="[object Object]"?Object.keys(this.marks).sort((s,i)=>+s-+i).map(s=>{const i=this.marks[s];return t(s,typeof i!="string"?i:{label:i})}):Array.isArray(this.marks)?this.marks.map(s=>t(s)):typeof this.marks=="function"?this.getValues().map(s=>({value:s,result:this.marks(s)})).filter(({result:s})=>!!s).map(({value:s,result:i})=>t(s,i)):[]}getRecentDot(t){const s=this.dotsPos.filter((i,o)=>!(this.getDotOption(o)&&this.getDotOption(o).disabled)).map(i=>Math.abs(i-t));return s.indexOf(Math.min(...s))}getIndexByValue(t){return this.data?this.data.indexOf(t):new W(+t).minus(this.min).divide(this.interval).toNumber()}getValueByIndex(t){return t<0?t=0:t>this.total&&(t=this.total),this.data?this.data[t]:new W(t).multiply(this.interval).plus(this.min).toNumber()}setDotPos(t,s){t=this.getValidPos(t,s).pos;const i=t-this.dotsPos[s];if(!i)return;let o=new Array(this.dotsPos.length);this.fixed?o=this.getFixedChangePosArr(i,s):this.minRange||this.maxRange?o=this.getLimitRangeChangePosArr(t,i,s):o[s]=i,this.setDotsPos(this.dotsPos.map((a,p)=>a+(o[p]||0)))}getFixedChangePosArr(t,s){return this.dotsPos.forEach((i,o)=>{if(o!==s){const{pos:a,inRange:p}=this.getValidPos(i+t,o);p||(t=Math.min(Math.abs(a-i),Math.abs(t))*(t<0?-1:1))}}),this.dotsPos.map(i=>t)}getLimitRangeChangePosArr(t,s,i){const o=[{index:i,changePos:s}],a=s;return[this.minRange,this.maxRange].forEach((p,x)=>{if(!p)return!1;const l=x===0,S=s>0;let C=0;l?C=S?1:-1:C=S?-1:1;const j=(f,y)=>{const R=Math.abs(f-y);return l?R<this.minRangeDir:R>this.maxRangeDir};let B=i+C,E=this.dotsPos[B],F=t;for(;this.isPos(E)&&j(E,F);){const{pos:f}=this.getValidPos(E+a,B);o.push({index:B,changePos:f-E}),B=B+C,F=f,E=this.dotsPos[B]}}),this.dotsPos.map((p,x)=>{const l=o.filter(S=>S.index===x);return l.length?l[0].changePos:0})}isPos(t){return typeof t=="number"}getValidPos(t,s){const i=this.valuePosRange[s];let o=!0;return t<i[0]?(t=i[0],o=!1):t>i[1]&&(t=i[1],o=!1),{pos:t,inRange:o}}parseValue(t){if(this.data)t=this.data.indexOf(t);else if(typeof t=="number"||typeof t=="string"){if(t=+t,t<this.min)return this.emitError(3),0;if(t>this.max)return this.emitError(4),0;if(typeof t!="number"||t!==t)return this.emitError(1),0;t=new W(t).minus(this.min).divide(this.interval).toNumber()}const s=new W(t).multiply(this.gap).toNumber();return s<0?0:s>100?100:s}parsePos(t){const s=Math.round(t/this.gap);return this.getValueByIndex(s)}isActiveByPos(t){return this.processArray.some(([s,i])=>t>=s&&t<=i)}getValues(){if(this.data)return this.data;{const t=[];for(let s=0;s<=this.total;s++)t.push(new W(s).multiply(this.interval).plus(this.min).toNumber());return t}}getRangeDir(t){return t?new W(t).divide(new W(this.data?this.data.length-1:this.max).minus(this.data?0:this.min).toNumber()).multiply(100).toNumber():100}emitError(t){this.onError&&this.onError(t,$e[t])}get processArray(){if(this.process){if(typeof this.process=="function")return this.process(this.dotsPos);if(this.dotsPos.length===1)return[[0,this.dotsPos[0]]];if(this.dotsPos.length>1)return[[Math.min(...this.dotsPos),Math.max(...this.dotsPos)]]}return[]}get total(){let t=0;return this.data?t=this.data.length-1:t=new W(this.max).minus(this.min).divide(this.interval).toNumber(),t-Math.floor(t)!==0?(this.emitError(2),0):t}get gap(){return 100/this.total}get minRangeDir(){return this.cacheRangeDir[this.minRange]?this.cacheRangeDir[this.minRange]:this.cacheRangeDir[this.minRange]=this.getRangeDir(this.minRange)}get maxRangeDir(){return this.cacheRangeDir[this.maxRange]?this.cacheRangeDir[this.maxRange]:this.cacheRangeDir[this.maxRange]=this.getRangeDir(this.maxRange)}getDotOption(t){return Array.isArray(this.dotOptions)?this.dotOptions[t]:this.dotOptions}getDotRange(t,s,i){if(!this.dotOptions)return i;const o=this.getDotOption(t);return o&&o[s]!==void 0?this.parseValue(o[s]):i}get valuePosRange(){const t=this.dotsPos,s=[];return t.forEach((i,o)=>{s.push([Math.max(this.minRange?this.minRangeDir*o:0,this.enableCross?0:t[o-1]||0,this.getDotRange(o,"min",0)),Math.min(this.minRange?100-this.minRangeDir*(t.length-1-o):100,this.enableCross?100:t[o+1]||100,this.getDotRange(o,"max",100))])}),s}get dotsIndex(){return this.dotsValue.map(t=>this.getIndexByValue(t))}}class Ae{constructor(t){M(this,"map"),M(this,"states",0),this.map=t}add(t){this.states|=t}delete(t){this.states&=~t}toggle(t){this.has(t)?this.delete(t):this.add(t)}has(t){return!!(this.states&t)}}const ct=4,T={None:0,Drag:2,Focus:4},Re={emits:["update:modelValue","change","drag-start","drag-end","dragging","error"],components:{VueSliderDot:Ft,VueSliderMark:Tt},props:{modelValue:{type:[Number,String,Array],default:0},silent:{type:Boolean,default:!1},direction:{type:String,default:"ltr",validator:e=>["ltr","rtl","ttb","btt"].indexOf(e)>-1},width:{type:[Number,String],default:void 0},height:{type:[Number,String],default:void 0},dotSize:{type:[Array,Number],default:14},contained:{type:Boolean,default:!1},min:{type:Number,default:0},max:{type:Number,default:100},interval:{type:Number,default:1},disabled:{type:Boolean,default:!1},clickable:{type:Boolean,default:!0},dragOnClick:{type:Boolean,default:!0},duration:{type:Number,default:.5},data:{type:[Object,Array],default:void 0},dataValue:{type:String,default:"value"},dataLabel:{type:String,default:"label"},lazy:{type:Boolean,default:!1},tooltip:{type:String,default:"active",validator:e=>["none","always","focus","hover","active"].indexOf(e)>-1},tooltipPlacement:{type:[String,Array],default:void 0,validator:e=>(Array.isArray(e)?e:[e]).every(t=>["top","right","bottom","left"].indexOf(t)>-1)},tooltipFormatter:{type:[String,Array,Function],default:""},useKeyboard:{type:Boolean,default:!0},keydownHook:{type:[Boolean,Function],default:void 0},enableCross:{type:Boolean,default:!0},fixed:{type:Boolean,default:!1},order:{type:Boolean,default:!0},minRange:{type:Number,default:void 0},maxRange:{type:Number,default:void 0},marks:{type:[Boolean,Object,Array,Function],default:!1},process:{type:[Boolean,Function],default:!0},zoom:{type:[Number],default:void 0},included:{type:[Boolean],default:!1},adsorb:{type:[Boolean],default:!1},hideLabel:{type:[Boolean],default:!1},dotOptions:{type:Object,default:void 0},dotAttrs:{type:Object,default:void 0},railStyle:{type:Object,default:null},processStyle:{type:Object,default:null},dotStyle:{type:Object,default:null},tooltipStyle:{type:Object,default:null},stepStyle:{type:Object,default:null},stepActiveStyle:{type:Object,default:null},labelStyle:{type:Object,default:null},labelActiveStyle:{type:Object,default:null}},data(){return{control:null,states:new Ae(T),scale:1,focusDotIndex:0}},computed:{tailSize(){return at((this.isHorizontal?this.height:this.width)||ct)},containerClasses(){return["vue-slider",[`vue-slider-${this.direction}`],{"vue-slider-disabled":this.disabled}]},containerStyles(){const[e,t]=Array.isArray(this.dotSize)?this.dotSize:[this.dotSize,this.dotSize],s=this.width?at(this.width):this.isHorizontal?"auto":at(ct),i=this.height?at(this.height):this.isHorizontal?at(ct):"auto";return{padding:this.contained?`${t/2}px ${e/2}px`:this.isHorizontal?`${t/2}px 0`:`0 ${e/2}px`,width:s,height:i}},processArray(){return this.control.processArray.map(([e,t,s],i)=>{e>t&&([e,t]=[t,e]);const o=this.isHorizontal?"width":"height";return{start:e,end:t,index:i,style:{[this.isHorizontal?"height":"width"]:"100%",[this.isHorizontal?"top":"left"]:0,[this.mainDirection]:`${e}%`,[o]:`${t-e}%`,transitionProperty:`${o},${this.mainDirection}`,transitionDuration:`${this.animateTime}s`,...this.processStyle,...s}}})},dotBaseStyle(){const[e,t]=Array.isArray(this.dotSize)?this.dotSize:[this.dotSize,this.dotSize];let s;return this.isHorizontal?s={transform:`translate(${this.isReverse?"50%":"-50%"}, -50%)`,"-WebkitTransform":`translate(${this.isReverse?"50%":"-50%"}, -50%)`,top:"50%",[this.direction==="ltr"?"left":"right"]:"0"}:s={transform:`translate(-50%, ${this.isReverse?"50%":"-50%"})`,"-WebkitTransform":`translate(-50%, ${this.isReverse?"50%":"-50%"})`,left:"50%",[this.direction==="btt"?"bottom":"top"]:"0"},{width:`${e}px`,height:`${t}px`,...s}},mainDirection(){switch(this.direction){case"ltr":return"left";case"rtl":return"right";case"btt":return"bottom";case"ttb":return"top"}},isHorizontal(){return this.direction==="ltr"||this.direction==="rtl"},isReverse(){return this.direction==="rtl"||this.direction==="btt"},tooltipDirections(){const e=this.tooltipPlacement||(this.isHorizontal?"top":"left");return Array.isArray(e)?e:this.dots.map(()=>e)},dots(){return this.control.dotsPos.map((e,t)=>({pos:e,index:t,value:this.control.dotsValue[t],focus:this.states.has(T.Focus)&&this.focusDotIndex===t,disabled:this.disabled,style:this.dotStyle,...(Array.isArray(this.dotOptions)?this.dotOptions[t]:this.dotOptions)||{}}))},animateTime(){return this.states.has(T.Drag)?0:this.duration},canSort(){return this.order&&!this.minRange&&!this.maxRange&&!this.fixed&&this.enableCross},sliderData(){return this.isObjectArrayData(this.data)?this.data.map(e=>e[this.dataValue]):this.isObjectData(this.data)?Object.keys(this.data):this.data},sliderMarks(){if(this.marks)return this.marks;if(this.isObjectArrayData(this.data))return e=>{const t={label:e};return this.data.some(s=>s[this.dataValue]===e?(t.label=s[this.dataLabel],!0):!1),t};if(this.isObjectData(this.data))return this.data},sliderTooltipFormatter(){if(this.tooltipFormatter)return this.tooltipFormatter;if(this.isObjectArrayData(this.data))return e=>{let t=""+e;return this.data.some(s=>s[this.dataValue]===e?(t=s[this.dataLabel],!0):!1),t};if(this.isObjectData(this.data)){const e=this.data;return t=>e[t]}},isNotSync(){const e=this.control.dotsValue;return Array.isArray(this.modelValue)?this.modelValue.length!==e.length||this.modelValue.some((t,s)=>t!==e[s]):this.modelValue!==e[0]},dragRange(){const e=this.dots[this.focusDotIndex-1],t=this.dots[this.focusDotIndex+1];return[e?e.pos:-1/0,t?t.pos:1/0]}},created(){this.initControl()},mounted(){this.bindEvent()},beforeUnmount(){this.unbindEvent()},methods:{isObjectData(e){return!!e&&Object.prototype.toString.call(e)==="[object Object]"},isObjectArrayData(e){return!!e&&Array.isArray(e)&&e.length>0&&typeof e[0]=="object"},bindEvent(){document.addEventListener("touchmove",this.dragMove,{passive:!1}),document.addEventListener("touchend",this.dragEnd,{passive:!1}),document.addEventListener("mousedown",this.blurHandle),document.addEventListener("mousemove",this.dragMove,{passive:!1}),document.addEventListener("mouseup",this.dragEnd),document.addEventListener("mouseleave",this.dragEnd),document.addEventListener("keydown",this.keydownHandle)},unbindEvent(){document.removeEventListener("touchmove",this.dragMove),document.removeEventListener("touchend",this.dragEnd),document.removeEventListener("mousedown",this.blurHandle),document.removeEventListener("mousemove",this.dragMove),document.removeEventListener("mouseup",this.dragEnd),document.removeEventListener("mouseleave",this.dragEnd),document.removeEventListener("keydown",this.keydownHandle)},setScale(){const e=new W(Math.floor(this.isHorizontal?this.$refs.rail.offsetWidth:this.$refs.rail.offsetHeight));this.zoom!==void 0&&e.multiply(this.zoom),e.divide(100),this.scale=e.toNumber()},initControl(){this.control=new Pe({value:this.modelValue,data:this.sliderData,enableCross:this.enableCross,fixed:this.fixed,max:this.max,min:this.min,interval:this.interval,minRange:this.minRange,maxRange:this.maxRange,order:this.order,marks:this.sliderMarks,included:this.included,process:this.process,adsorb:this.adsorb,dotOptions:this.dotOptions,onError:this.emitError}),this.syncValueByPos(),["data","enableCross","fixed","max","min","interval","minRange","maxRange","order","marks","process","adsorb","included","dotOptions"].forEach(e=>{this.$watch(e,t=>{if(e==="data"&&Array.isArray(this.control.data)&&Array.isArray(t)&&this.control.data.length===t.length&&t.every((s,i)=>s===this.control.data[i]))return!1;switch(e){case"data":case"dataLabel":case"dataValue":this.control.data=this.sliderData;break;case"mark":this.control.marks=this.sliderMarks;break;default:this.control[e]=t}["data","max","min","interval"].indexOf(e)>-1&&this.control.syncDotsPos()})})},syncValueByPos(){const e=this.control.dotsValue;if(this.isDiff(e,Array.isArray(this.modelValue)?this.modelValue:[this.modelValue])){const t=e.length===1?e[0]:[...e];this.$emit("change",t,this.focusDotIndex),this.$emit("update:modelValue",t,this.focusDotIndex)}},isDiff(e,t){return e.length!==t.length||e.some((s,i)=>s!==t[i])},emitError(e,t){this.silent||console.error(`[VueSlider error]: ${t}`),this.$emit("error",e,t)},dragStartOnProcess(e){if(this.dragOnClick){this.setScale();const t=this.getPosByEvent(e),s=this.control.getRecentDot(t);if(this.dots[s].disabled)return;this.dragStart(s),this.control.setDotPos(t,this.focusDotIndex),this.lazy||this.syncValueByPos()}},dragStart(e){this.focusDotIndex=e,this.setScale(),this.states.add(T.Drag),this.states.add(T.Focus),this.$emit("drag-start",this.focusDotIndex)},dragMove(e){if(!this.states.has(T.Drag))return!1;e.preventDefault();const t=this.getPosByEvent(e);this.isCrossDot(t),this.control.setDotPos(t,this.focusDotIndex),this.lazy||this.syncValueByPos();const s=this.control.dotsValue;this.$emit("dragging",s.length===1?s[0]:[...s],this.focusDotIndex)},isCrossDot(e){if(this.canSort){const t=this.focusDotIndex;let s=e;if(s>this.dragRange[1]?(s=this.dragRange[1],this.focusDotIndex++):s<this.dragRange[0]&&(s=this.dragRange[0],this.focusDotIndex--),t!==this.focusDotIndex){const i=this.$refs[`dot-${this.focusDotIndex}`];i&&i.$el&&i.$el.focus(),this.control.setDotPos(s,t)}}},dragEnd(e){if(!this.states.has(T.Drag))return!1;setTimeout(()=>{this.lazy&&this.syncValueByPos(),this.included&&this.isNotSync?this.control.setValue(this.modelValue):this.control.syncDotsPos(),this.states.delete(T.Drag),(!this.useKeyboard||"targetTouches"in e)&&this.states.delete(T.Focus),this.$emit("drag-end",this.focusDotIndex)})},blurHandle(e){if(!this.states.has(T.Focus)||!this.$refs.container||this.$refs.container.contains(e.target))return!1;this.states.delete(T.Focus)},clickHandle(e){if(!this.clickable||this.disabled)return!1;if(this.states.has(T.Drag))return;this.setScale();const t=this.getPosByEvent(e);this.setValueByPos(t)},focus(e=0){this.states.add(T.Focus),this.focusDotIndex=e},blur(){this.states.delete(T.Focus)},getValue(){const e=this.control.dotsValue;return e.length===1?e[0]:e},getIndex(){const e=this.control.dotsIndex;return e.length===1?e[0]:e},setValue(e){this.control.setValue(Array.isArray(e)?[...e]:[e]),this.syncValueByPos()},setIndex(e){const t=Array.isArray(e)?e.map(s=>this.control.getValueByIndex(s)):this.control.getValueByIndex(e);this.setValue(t)},setValueByPos(e){const t=this.control.getRecentDot(e);if(this.disabled||this.dots[t].disabled)return!1;this.focusDotIndex=t,this.control.setDotPos(e,t),this.syncValueByPos(),this.useKeyboard&&this.states.add(T.Focus),setTimeout(()=>{this.included&&this.isNotSync?this.control.setValue(this.modelValue):this.control.syncDotsPos()})},keydownHandle(e){if(!this.useKeyboard||!this.states.has(T.Focus))return!1;const t=this.included&&this.marks,s=Ve(e,{direction:this.direction,max:t?this.control.markList.length-1:this.control.total,min:0,hook:this.keydownHook});if(s){e.preventDefault();let i=-1,o=0;t?(this.control.markList.some((a,p)=>a.value===this.control.dotsValue[this.focusDotIndex]?(i=s(p),!0):!1),i<0?i=0:i>this.control.markList.length-1&&(i=this.control.markList.length-1),o=this.control.markList[i].pos):(i=s(this.control.getIndexByValue(this.control.dotsValue[this.focusDotIndex])),o=this.control.parseValue(this.control.getValueByIndex(i))),this.isCrossDot(o),this.control.setDotPos(o,this.focusDotIndex),this.syncValueByPos()}},getPosByEvent(e){return De(e,this.$refs.rail,this.isReverse)[this.isHorizontal?"x":"y"]/this.scale}},watch:{modelValue:{handler(){this.control&&!this.states.has(T.Drag)&&this.isNotSync&&(this.control.setValue(this.modelValue),this.syncValueByPos())},deep:!0}}},Oe={key:0,class:"vue-slider-marks"};function Me(e,t,s,i,o,a){const p=St("VueSliderMark"),x=St("VueSliderDot");return k(),P("div",q({ref:"container",class:a.containerClasses,style:a.containerStyles,onClick:t[1]||(t[1]=(...l)=>a.clickHandle&&a.clickHandle(...l)),onTouchstartPassive:t[2]||(t[2]=(...l)=>a.dragStartOnProcess&&a.dragStartOnProcess(...l)),onMousedown:t[3]||(t[3]=(...l)=>a.dragStartOnProcess&&a.dragStartOnProcess(...l))},e.$attrs),[d("div",{ref:"rail",class:"vue-slider-rail",style:U(s.railStyle)},[(k(!0),P(K,null,G(a.processArray,(l,S)=>H(e.$slots,"process",q({ref_for:!0},{...l}),()=>[(k(),P("div",{class:"vue-slider-process",key:`process-${S}`,style:U(l.style)},null,4))])),256)),a.sliderMarks?(k(),P("div",Oe,[(k(!0),P(K,null,G(o.control.markList,(l,S)=>H(e.$slots,"mark",q({ref_for:!0},{...l}),()=>[(k(),Q(p,{key:`mark-${S}`,mark:l,hideLabel:s.hideLabel,style:U({[a.isHorizontal?"height":"width"]:"100%",[a.isHorizontal?"width":"height"]:a.tailSize,[a.mainDirection]:`${l.pos}%`}),stepStyle:s.stepStyle,stepActiveStyle:s.stepActiveStyle,labelStyle:s.labelStyle,labelActiveStyle:s.labelActiveStyle,onPressLabel:C=>s.clickable&&a.setValueByPos(C)},{step:_(()=>[H(e.$slots,"step",q({ref_for:!0},{...l}))]),label:_(()=>[H(e.$slots,"label",q({ref_for:!0},{...l}))]),_:2},1032,["mark","hideLabel","style","stepStyle","stepActiveStyle","labelStyle","labelActiveStyle","onPressLabel"]))])),256))])):Z("",!0),(k(!0),P(K,null,G(a.dots,(l,S)=>(k(),P(K,null,[L(x,q({ref_for:!0,ref:`dot-${S}`,value:l.value,disabled:l.disabled,focus:l.focus,"dot-style":[l.style,l.disabled?l.disabledStyle:null,l.focus?l.focusStyle:null],tooltip:l.tooltip||s.tooltip,"tooltip-style":[s.tooltipStyle,l.tooltipStyle,l.disabled?l.tooltipDisabledStyle:null,l.focus?l.tooltipFocusStyle:null],"tooltip-formatter":Array.isArray(a.sliderTooltipFormatter)?a.sliderTooltipFormatter[S]:a.sliderTooltipFormatter,"tooltip-placement":a.tooltipDirections[S],style:[a.dotBaseStyle,{[a.mainDirection]:`${l.pos}%`,transition:`${a.mainDirection} ${a.animateTime}s`}],"onDrag-start":()=>a.dragStart(S),role:"slider","aria-valuenow":l.value,"aria-valuemin":this.min,"aria-valuemax":this.max,"aria-orientation":this.isHorizontal?"horizontal":"vertical",tabindex:"0",onFocus:()=>!l.disabled&&a.focus(S),onBlur:t[0]||(t[0]=()=>a.blur())},{...s.dotAttrs}),{dot:_(()=>[H(e.$slots,"dot",q({ref_for:!0},{...l}))]),tooltip:_(()=>[H(e.$slots,"tooltip",q({ref_for:!0},{...l}))]),_:2},1040,["value","disabled","focus","dot-style","tooltip","tooltip-style","tooltip-formatter","tooltip-placement","style","onDrag-start","aria-valuenow","aria-valuemin","aria-valuemax","aria-orientation","onFocus"]),H(e.$slots,"default",q({ref_for:!0},{value:a.getValue()}))],64))),256))],4)],16)}const kt=_t(Re,[["render",Me]]);kt.VueSliderMark=Tt;kt.VueSliderDot=Ft;const Le={class:"loop-multiply"},Ee={class:"loan-ltv-value"},Ne={class:"loan-ltv-value__multiplier"},Ce={class:"loan-ltv-value__multiplier__value"},Be=lt({__name:"MultiplySelect",props:pt({multiplier:{},maxMultiply:{}},{modelValue:{default:0},modelModifiers:{}}),emits:["update:modelValue"],setup(e){const t=D(()=>e.maxMultiply&&Math.round(1/Number(e.maxMultiply)*100)),s=D(()=>({[t.value]:"x1",100:`x${e.maxMultiply}`})),i=vt(e,"modelValue");function o(){if(i.value<=5){i.value=0;return}i.value>5&&i.value<=10&&(i.value=10)}function a(p){const x=Number(i.value),l=Number(p.value);return x<l+20&&l===t.value?(x-l-5)/10:x>80&&l===100?1-(x-85)/10:1}return(p,x)=>(k(),P("div",Le,[d("div",Ee,[d("div",Ne,[x[1]||(x[1]=I(" Multiplier ")),d("div",Ce," x"+g(p.multiplier),1)])]),L(r(kt),{modelValue:i.value,"onUpdate:modelValue":x[0]||(x[0]=l=>i.value=l),interval:.1,min:r(t),max:100,"dot-size":25,contained:!0,height:"12px",tooltip:"none",class:"ltv-select-slider",marks:r(s),onDragEnd:o},{dot:_(()=>x[2]||(x[2]=[d("div",{class:"slider-thumb"},null,-1)])),mark:_(l=>[d("div",{class:"vue-slider-mark",style:U({left:`${l.pos}%`})},[d("div",{class:"vue-slider-mark__label",style:U({opacity:a(l)})},g(l==null?void 0:l.label),5)],4)]),_:1},8,["modelValue","min","marks"])]))}}),Fe={class:"multiply-dialog__title"},Te={class:"multiply-dialog__body"},je={class:"multiply-dialog__data"},Ie={class:"asset-popover__list"},ze=["src","alt"],He=["src","alt"],Ue={key:0,class:"dialog-info-table"},Ye=["href"],qe={key:1},We={class:"multiply-dialog-action"},Ke=lt({__name:"MultiplyDialog",props:pt({data:{}},{modelValue:{type:Boolean,default:!1},modelModifiers:{}}),emits:["update:modelValue"],setup(e){function t(c,h,A){return A<=1?c:c/h/A}const s=gt(),i=yt(),o=bt(i,"depositAmount"),a=mt(),p=D(()=>a.jLendClient),x=Vt(),l=D(()=>x.publicKey),S=z(!0),C=D(()=>{var A,O;const c=(A=e.data)==null?void 0:A.depositPool.token_ticker,h=(O=e.data)==null?void 0:O.borrowPool.token_ticker;return[c,h].map(m=>({name:m,icon:nt(String(m))}))}),j=D(()=>C.value[S.value?0:1]),B=D(()=>C.value[S.value?1:0]),E=D(()=>{if(!e.data)return 0;const c=S.value?e.data.depositPool.name:e.data.borrowPool.name;if(c==="native")return x.nativeBalance;const[,h]=Wt(c);return x.getAssetBalance(String(h))}),F=z(90),f=D(()=>{var c;return((c=e.data)==null?void 0:c.multiplier)||0}),y=D(()=>Number(F.value/100*f.value).toFixed(2)),R=D(()=>{var c;return s.poolDepositAddr===((c=e.data)==null?void 0:c.depositPool.pool_address)}),N=z(!1),u=z(0);$t([()=>e.data,N,l],async([c,h])=>{var O;if(!c||!l.value)return;const A=await((O=p.value)==null?void 0:O.sdk.leverageTx(l.value,(c==null?void 0:c.depositPool.pool_address)||"",(c==null?void 0:c.borrowPool.pool_address)||"",1,2));u.value=p.value.sdk.getTransactionFee(A)},{immediate:!0,debounce:300});const n=z(0),V=D(()=>{if(!e.data)return[];const c=S.value?e.data.depositPool:e.data.borrowPool,h=e.data.borrowPool,A=ot(h.available,a.assetDecimals),O=Number(A)*Number(h.pool_price),m=S.value?e.data.depositPool.token_ticker:e.data.borrowPool.token_ticker;return n.value=t(O,Number((c==null?void 0:c.pool_price)||0),Number(y.value)||0),[{name:"liquidity",label:"Liquidity Available",value:`${et(A||0,2,2)} ${h.token_ticker}`},{name:"maxApy",label:"Max APY",value:`${ht(e.data.maxAPY||0,2)} %`},{name:"maxMultiply",label:"Max Multiply",value:`${et(Number(n.value).toFixed(2)||0,2)} ${m}`},{name:"multiplier",label:"Avg. Multiplier",value:"90.00 %"},{name:"supplied",label:"Total Supplied",value:`${et(e.data.supplied||0,2,2)} ${e.data.asset.symbol}`},{name:"txFee",label:"Transaction Fee",value:`${u.value} XLM`}]}),b=vt(e,"modelValue");async function $(){var O,m,Y,X;if(!l.value||!((O=e.data)!=null&&O.depositPool.pool_address))return;if(!o.value||o.value<=0){Ct(".multiply-dialog");return}const c=(m=e.data)==null?void 0:m.depositPool.pool_address,h=((Y=s.state.pools.find(it=>it.token_ticker==="XLM"))==null?void 0:Y.pool_address)||"",A=(X=e.data)==null?void 0:X.depositPool.token_ticker;!c||!h||await i.leverage(c,h,Number(o.value),Number(y.value),A)}let w;return ft(b,async c=>{if(clearInterval(w),!c){setTimeout(()=>{o.value=0},Pt);return}w=At(()=>{N.value=!0,Ot(()=>{N.value=!1})},Rt)}),(c,h)=>{const A=ie,O=Et,m=se,Y=Be,X=Bt,it=be,dt=Nt;return k(),Q(dt,{modelValue:b.value,"onUpdate:modelValue":h[3]||(h[3]=tt=>b.value=tt),"class-name":"multiply-dialog"},{header:_(()=>[d("div",Fe,[d("span",null,"Multiply "+g(r(j).name),1)])]),default:_(()=>{var tt;return[d("div",Te,[d("div",je,[L(O,{modelValue:r(o),"onUpdate:modelValue":h[1]||(h[1]=v=>st(o)?o.value=v:null),balance:r(E),limit:r(n),class:"multiply-dialog__input","label-left":"You Deposit",rules:[v=>v&&Number(v)<r(E)||"Insufficient balance",v=>r(n)<=0||Number(v)<=r(n)||"Pool leverage limit"]},{"label-right":_(()=>[I(" Wallet: "+g(r(E))+" "+g(r(j).name),1)]),prepend:_(()=>[L(A,{"class-name":"asset-popover",position:"bottom","teleport-to-body":!1,"close-popup":""},{target:_(()=>{var v;return[d("img",{src:(v=r(j))==null?void 0:v.icon,alt:`${r(j).name} icon`},null,8,He)]}),default:_(()=>{var v;return[d("ul",Ie,[d("li",{class:"asset-popover__list-item",onClick:h[0]||(h[0]=fs=>S.value=!r(S))},[d("img",{src:(v=r(B))==null?void 0:v.icon,alt:`${r(B).name} icon`},null,8,ze),d("span",null,g(r(B).name),1)])])]}),_:1})]),_:1},8,["modelValue","balance","limit","rules"]),h[4]||(h[4]=d("div",{class:"multiply-dialog__notice"}," Notice: In this version, multiply via the borrow token is available. ",-1)),r(V).length>0?(k(),P("div",Ue,[(k(!0),P(K,null,G(r(V),v=>(k(),P("div",{key:v==null?void 0:v.label,class:"dialog-info-table__item"},[d("span",null,g(v==null?void 0:v.label),1),(v==null?void 0:v.name)==="contract"?(k(),P("a",{key:0,href:r(It)(String(v==null?void 0:v.value),"contract"),target:"_blank"},[I(g(r(ae)(v==null?void 0:v.value,5))+" ",1),L(m)],8,Ye)):(k(),P("span",qe,g(v==null?void 0:v.value),1))]))),128))])):Z("",!0),L(Y,{modelValue:r(F),"onUpdate:modelValue":h[2]||(h[2]=v=>st(F)?F.value=v:null),multiplier:r(y),"max-multiply":r(f)},null,8,["modelValue","multiplier","max-multiply"]),d("div",We,[L(X,{variant:"primary",loading:r(R),pool:(tt=c.data)==null?void 0:tt.depositPool,disabled:Number(r(y))<1,onClickHandler:$},{default:_(()=>{var v;return[I(" Multiply "+g((v=c.data)==null?void 0:v.asset.symbol),1)]}),_:1},8,["loading","pool","disabled"])])]),L(it)])]}),_:1},8,["modelValue"])}}}),Xe={key:1,class:"table-wrapper"},Je={class:"market-table__asset"},Ge=["src"],Qe=["src"],Ze={class:"market-table__asset__info"},ts={class:"market-table__asset__info__name"},es={class:"market-table__asset__info__symbol"},ss={class:"table-cell cell-apy"},is={class:"table-cell justify-content-center"},as={class:"table-cell justify-content-end"},os={class:"table-cell justify-content-end"},ls={class:"table-cell justify-content-end"},rs={class:"table-cell justify-content-end market-table__action"},ns={class:"no-data"},ds=lt({__name:"MultiplyTable",setup(e){const t=mt(),s=gt(),i=yt(),o=Lt(),a=D(()=>o.userObligation),p=D(()=>t.assetDecimals),x=D(()=>s.selectedMarketPools),l=D(()=>s.state.leveragePools),S=D(()=>s.state.loadingLeveragePools||s.state.loading);function C(u){if(!Number.isInteger(u)||u<0||u>=1e4)throw new Error(`ltvByBps must be integer in [0,10000), got ${u}`);const n=new ut(u).div(1e4);return n.eq(1)?1/0:new ut(1).div(new ut(1).minus(n)).toNumber()}const j=[{key:"asset",label:"Vault",align:"left"},{key:"maxAPY",label:"Max APY",align:"center"},{key:"multiplier",label:"Multiplier",align:"center"},{key:"liquidity",label:"Liquidity",align:"right"},{key:"supplied",label:"Supplied",align:"right"},{key:"borrowing",label:"Borrowing",align:"right"},{key:"action",label:""}],B=D(()=>{var u;return(u=l.value)==null?void 0:u.map(({borrow_pool:n,deposit_pool:V})=>{const b=x.value.find(v=>v.pool_address===V),$=x.value.find(v=>v.pool_address===n),w=b==null?void 0:b.token_ticker,c=$==null?void 0:$.token_ticker,h=wt(String(w)),A=nt(String(w)),O=wt(String(c)),m=nt(String(c)),Y=Number(b==null?void 0:b.config.open_ltv_bps)||0,X=C(Y),it=((Number((b==null?void 0:b.pool_apy.supply_bps)||0)-Number((b==null?void 0:b.pool_apy.borrow_bps)||0))*X+Number((b==null?void 0:b.pool_apy.borrow_bps)||0))/100,dt=b&&b.available?Number(ot(b.available,p.value)):0,tt=$&&$.available?Number(ot($.available,p.value)):0;return{depositPool:b,borrowPool:$,asset:{name:h,symbol:w,icon:A},borrowAsset:{name:O,symbol:c,icon:m},liquidity:tt,multiplier:X,maxAPY:it,price:Number(b==null?void 0:b.pool_price)||0,borrowPoolPrice:Number($==null?void 0:$.pool_price)||0,pool_address:(b==null?void 0:b.pool_address)||"",supplied:dt}})}),E=z(!1),F=z(!1),f=z(),y=D(()=>B.value.find(u=>u.pool_address===f.value));async function R(u,n){var V;f.value=(V=u.item)==null?void 0:V.pool_address,n==="supply"?E.value=!0:F.value=!0}function N(u){var h,A;const n=((h=a.value)==null?void 0:h.deposits)||[],V=((A=a.value)==null?void 0:A.borrows)||[];if(n.length===0||V.length===0)return!1;const b=u.depositPool.pool_address,$=u.borrowPool.pool_address,w=n.some(O=>O.includes(b)),c=V.some(O=>O.includes($));return w&&c}return(u,n)=>{const V=Kt,b=Jt,$=Xt,w=Ht,c=zt,h=Gt,A=Ke,O=ue;return k(),P(K,null,[r(x).length===0&&r(S)?(k(),P(K,{key:0},[L(V,{height:"36","full-width":"",style:{"border-radius":"8px"}}),L(V,{height:"80","full-width":"",style:{"margin-top":"8px","border-radius":"8px"}})],64)):(k(),P("div",Xe,[L(c,{"show-empty":"",borderless:"",fields:j,items:r(B),responsive:"",class:"market-table multiply-table"},Ut({"cell(asset)":_(m=>[d("div",Je,[d("img",{src:m.item.asset.icon,alt:"asset icon"},null,8,Ge),d("img",{src:r(nt)("XLM"),alt:"XLM icon",class:"xlm-icon"},null,8,Qe),d("div",Ze,[d("div",ts,g(m.item.asset.symbol)+"/"+g(m.item.borrowAsset.symbol),1),d("div",es,g(m.item.asset.name)+" / "+g(m.item.borrowAsset.symbol),1)])])]),"cell(maxAPY)":_(m=>[d("div",ss,g(r(ht)(m.item.maxAPY||0,2))+"% ",1)]),"cell(multiplier)":_(m=>[d("div",is,[L(b,{color:"#111","bg-color":"rgba(8, 181, 118, 0.50)",size:"md"},{default:_(()=>[I(g(r(ht)(m.item.multiplier||0,2))+"x ",1)]),_:2},1024)])]),"cell(liquidity)":_(m=>[d("div",as,[L($,{"tooltip-class":"with-price"},{content:_(()=>[I(g(r(et)(m.item.liquidity))+" "+g(m.item.borrowAsset.symbol)+" ",1),n[2]||(n[2]=d("br",null,null,-1)),d("span",null,"$"+g(r(rt)(m.item.liquidity,m.item.borrowPoolPrice,!1)),1)]),default:_(()=>[d("strong",null,g(r(Dt)(m.item.liquidity||0))+" "+g(m.item.borrowAsset.symbol),1),d("span",null,"$"+g(r(rt)(m.item.liquidity,m.item.borrowPoolPrice)),1)]),_:2},1024)])]),"cell(supplied)":_(m=>[d("div",os,[L($,{"tooltip-class":"with-price"},{content:_(()=>[I(g(r(et)(m.item.supplied))+" "+g(m.item.asset.symbol)+" ",1),n[3]||(n[3]=d("br",null,null,-1)),d("span",null,"$"+g(r(rt)(m.item.supplied,m.item.price,!1)),1)]),default:_(()=>[d("strong",null,g(r(Dt)(m.item.supplied.toFixed(2)||0))+" "+g(m.item.asset.symbol),1),d("span",null,"$"+g(r(rt)(m.item.supplied,m.item.price)),1)]),_:2},1024)])]),"cell(borrowing)":_(m=>[d("div",ls,g(m.item.borrowAsset.symbol),1)]),"cell(action)":_(m=>[d("div",rs,[L(w,{size:"lg",pill:"","icon-right":"",disabled:r(i).isDisabled(m.item.pool_address,"leverage"),loading:r(i).isLoading(m.item.pool_address,"leverage"),onClick:Y=>R(m,"supply")},{default:_(()=>n[4]||(n[4]=[I(" Multiply ")])),_:2,__:[4]},1032,["disabled","loading","onClick"]),N(m.item)?(k(),Q(w,{key:0,size:"lg",variant:"accent",pill:"","icon-right":"",disabled:r(i).isDisabled(m.item.pool_address,"withdrawLeverage"),loading:r(i).isLoading(m.item.pool_address,"withdrawLeverage"),onClick:Y=>R(m,"withdraw")},{default:_(()=>n[5]||(n[5]=[I(" Withdraw ")])),_:2,__:[5]},1032,["disabled","loading","onClick"])):Z("",!0)])]),empty:_(()=>[Yt(d("div",ns," No Markets ",512),[[qt,!r(S)]])]),_:2},[G(j,m=>({name:`head(${m.key})`,fn:_(Y=>[d("span",{style:U({"--align":m.align})},g(Y.label),5)])}))]),1032,["items"]),r(S)?(k(),Q(h,{key:0},{default:_(()=>n[6]||(n[6]=[I(" Loading... ")])),_:1,__:[6]})):Z("",!0)])),L(A,{modelValue:r(E),"onUpdate:modelValue":n[0]||(n[0]=m=>st(E)?E.value=m:null),data:r(y)},null,8,["modelValue","data"]),L(O,{modelValue:r(F),"onUpdate:modelValue":n[1]||(n[1]=m=>st(F)?F.value=m:null),data:r(y)},null,8,["modelValue","data"])],64)}}}),us={},cs={class:"multiply-page container"},hs={class:"card"};function ms(e,t){const s=ds;return k(),P("main",cs,[t[0]||(t[0]=d("h2",{class:"multiply-page__title"}," Stellar Multiply ",-1)),d("div",hs,[L(s)])])}const ps=Mt(us,[["render",ms]]),bs={};function vs(e,t){const s=ps;return k(),Q(s)}const Ss=Mt(bs,[["render",vs]]);export{Ss as default};
